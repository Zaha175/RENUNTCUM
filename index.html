<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linie Timp Editabilă - Renunțare la Alcool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.module.js"
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Basis Schriftart */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease; /* Übergang für Dark Mode */
        }

        /* Stile für editierbare Spans */
        .editable-span {
            cursor: text;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px dashed transparent;
            transition: border 0.2s ease, background-color 0.2s ease;
            display: inline-block;
            margin-right: 5px;
        }
        .editable-span:focus {
            background-color: #ffffff;
            outline: none;
            border: 1px dashed #3b82f6; /* blue-500 */
            box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
        }
        .dark .editable-span:focus { /* Dark mode focus */
             background-color: #4b5563; /* gray-600 */
             border: 1px dashed #60a5fa; /* blue-400 */
             box-shadow: 0 0 5px rgba(96, 165, 250, 0.5);
        }

        /* Spezifische Stile für Datum/Intervall */
        .date-display {
            color: #dc2626; /* red-600 */
            font-weight: 600;
            background-color: rgba(252, 165, 165, 0.2);
        }
        .dark .date-display {
             color: #f87171; /* red-400 */
             background-color: rgba(248, 113, 113, 0.15);
        }
        .interval-display {
            color: #16a34a; /* green-600 */
            font-weight: 600;
            background-color: rgba(74, 222, 128, 0.2);
        }
        .dark .interval-display {
             color: #4ade80; /* green-400 */
             background-color: rgba(74, 222, 128, 0.15);
        }

        /* --- Logo CSS Start --- */
        #logo-container {
            position: absolute;
            top: 1rem;      /* entspricht top-4 */
            left: 1rem;     /* entspricht left-4 */
            width: 4rem;    /* kleiner als im Original (w-16) */
            height: 4rem;   /* kleiner als im Original (h-16) */
            z-index: 50;    /* Hoher z-index */
            pointer-events: none;
        }
        /* Responsive Anpassung */
        @media (min-width: 640px) { /* sm: */
            #logo-container {
                width: 5rem;  /* sm:w-20 */
                height: 5rem; /* sm:h-20 */
            }
        }
        #logo-canvas {
            display: block;
            width: 100%;
            height: 100%;
            cursor: pointer;
            pointer-events: auto;
        }
        /* --- Logo CSS Ende --- */

        /* --- Banner Animationen Start --- */
        @keyframes pulse {
            0% { box-shadow: 0 0 8px 0px rgba(250, 204, 21, 0.4); }
            50% { box-shadow: 0 0 15px 4px rgba(250, 204, 21, 0.6); }
            100% { box-shadow: 0 0 8px 0px rgba(250, 204, 21, 0.4); }
        }
        .dark @keyframes pulse { /* Dark mode pulse (optional: slightly different color?) */
             0% { box-shadow: 0 0 8px 0px rgba(253, 224, 71, 0.5); } /* yellow-300 */
             50% { box-shadow: 0 0 15px 4px rgba(253, 224, 71, 0.7); }
             100% { box-shadow: 0 0 8px 0px rgba(253, 224, 71, 0.5); }
        }
        @keyframes textGlow {
            from { text-shadow: 0 0 3px #facc15, 0 0 6px #fde047; } /* yellow-400/300 */
            to { text-shadow: 0 0 6px #facc15, 0 0 10px #fde047, 0 0 15px #fbbf24; } /* yellow-400/300 / amber-400 */
        }
        .dark @keyframes textGlow { /* Dark mode glow */
             from { text-shadow: 0 0 4px #fde047, 0 0 8px #fef08a; } /* yellow-300/200 */
             to { text-shadow: 0 0 8px #fde047, 0 0 12px #fef08a, 0 0 18px #fcd34d; } /* yellow-300/200 / amber-300 */
        }
        .cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background-color: #facc15; /* yellow-400 */
            margin-left: 4px;
            animation: blink 1s infinite;
            vertical-align: bottom;
        }
        .dark .cursor {
             background-color: #fde047; /* yellow-300 */
        }
        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }
        #ad-banner {
            animation: pulse 3s infinite ease-in-out;
            box-sizing: border-box;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease; /* Übergang */
        }
        #ad-banner .text-glow {
            animation: textGlow 2.5s ease-in-out infinite alternate;
        }
        #ad-banner:hover .text-glow,
        #ad-banner:hover .cursor,
        #ad-banner:hover {
             animation-play-state: paused;
        }
        /* --- Banner Animationen Ende --- */

        /* Dark Mode Button Styling */
        #darkModeToggle {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 50;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-blue-100 via-purple-100 to-pink-100 dark:from-gray-900 dark:via-indigo-900 dark:to-gray-800 min-h-screen p-4 md:p-8 text-gray-800 dark:text-gray-200">

    <div id="logo-container">
        <canvas id="logo-canvas"></canvas>
    </div>

    <button id="darkModeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        <svg id="darkModeIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
    </button>

    <div class="container mx-auto max-w-3xl bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transition-colors duration-300">

        <div id="ad-banner" class="text-center p-4 bg-gradient-to-r from-blue-800 to-indigo-900 dark:from-blue-900 dark:to-indigo-950 text-yellow-300 dark:text-yellow-200 text-base md:text-lg font-medium border-b-4 border-yellow-400 dark:border-yellow-500 min-h-[3em] flex items-center justify-center overflow-hidden relative">
            <span class="text-glow"></span><span class="cursor"></span>
        </div>

        <div class="p-6 md:p-8">
            <h1 class="text-center text-3xl md:text-4xl font-bold text-indigo-800 dark:text-indigo-300 mb-6 transition-colors duration-300">
                Linie Timp - Renunțare la Alcool
            </h1>

            <p class="edit-note text-sm text-gray-600 dark:text-gray-400 text-center mb-6 p-3 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg transition-colors duration-300">
                Poți edita datele specifice (<strong class="text-red-600 dark:text-red-400">roșu</strong>) și intervalele (<strong class="text-green-600 dark:text-green-400">verde</strong>) direct făcând clic pe ele.
                Te rog păstrează formatul <strong>ZZ.LL.AAAA</strong> pentru datele specifice și asigură-te că intervalele modificate se potrivesc cronologic.
            </p>

            <ul id="timelineList" class="space-y-4">
                <li class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-700 dark:to-indigo-800 p-4 rounded-lg shadow-sm dark:shadow-md border-l-4 border-blue-500 dark:border-blue-400 transition duration-300 ease-in-out hover:shadow-md dark:hover:shadow-lg">
                    <strong class="date-display editable-span" contenteditable="true">09.10.2022</strong> Accident sub influența alcoolului – M-am gândit doar la mine, am fost egoist și am pus vieți în pericol.
                </li>
                <li class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-700 dark:to-indigo-800 p-4 rounded-lg shadow-sm dark:shadow-md border-l-4 border-purple-500 dark:border-purple-400 transition duration-300 ease-in-out hover:shadow-md dark:hover:shadow-lg">
                    <strong class="interval-display editable-span" contenteditable="true">Octombrie 2022 – Ianuarie 2023</strong> Am continuat să beau ca la început – excesiv și fără control.
                </li>
                <li class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-700 dark:to-indigo-800 p-4 rounded-lg shadow-sm dark:shadow-md border-l-4 border-purple-500 dark:border-purple-400 transition duration-300 ease-in-out hover:shadow-md dark:hover:shadow-lg">
                    <strong class="interval-display editable-span" contenteditable="true">Februarie – Mai 2023</strong> Am redus treptat consumul – din ce în ce mai puțin, pe măsură ce conștientizam consecințele.
                </li>
                <li class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-gray-700 dark:to-emerald-800 p-4 rounded-lg shadow-sm dark:shadow-md border-l-4 border-green-500 dark:border-green-400 transition duration-300 ease-in-out hover:shadow-md dark:hover:shadow-lg">
                    <strong class="date-display editable-span" contenteditable="true">31.05.2023</strong> Ultima bere – decizie conștientă de a renunța definitiv.
                </li>
                <li class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-gray-700 dark:to-emerald-800 p-4 rounded-lg shadow-sm dark:shadow-md border-l-4 border-emerald-600 dark:border-emerald-500 transition duration-300 ease-in-out hover:shadow-md dark:hover:shadow-lg">
                    <strong class="date-display editable-span" contenteditable="true">01.06.2023</strong> Începutul abstinenței – Nu am mai consumat alcool de atunci!
                </li>
            </ul>
        </div>
    </div>

    <script>
        // --- START Dark Mode Logic ---
        const darkModeToggle = document.getElementById('darkModeToggle');
        const darkModeIcon = document.getElementById('darkModeIcon');
        const userPrefersDark = localStorage.getItem('darkMode') === 'true' ||
                                (!('darkMode' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);

        // Icons HTML (using Lucide names)
        const sunIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>`;
        const moonIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>`;

        // Function to apply the theme
        const applyTheme = (isDark) => {
            if (isDark) {
                document.documentElement.classList.add('dark');
                darkModeIcon.innerHTML = sunIcon; // Show sun icon in dark mode
                localStorage.setItem('darkMode', 'true');
            } else {
                document.documentElement.classList.remove('dark');
                darkModeIcon.innerHTML = moonIcon; // Show moon icon in light mode
                localStorage.setItem('darkMode', 'false');
            }
             // Re-initialize Lucide icons after changing innerHTML
            if (typeof lucide !== 'undefined') {
                 lucide.createIcons();
            }
        };

        // Apply initial theme based on preference
        applyTheme(userPrefersDark);

        // Add event listener to the toggle button
        darkModeToggle.addEventListener('click', () => {
            const isCurrentlyDark = document.documentElement.classList.contains('dark');
            applyTheme(!isCurrentlyDark);
        });
        // --- END Dark Mode Logic ---


        // --- START JavaScript Banner ---
        let typeWriterTimeoutId = null;
        let typingTimeoutId = null;
        const TYPEWRITER_SPEED = 85;
        const RESTART_DELAY = 4000;

        function typeWriter(textElement, cursorElement, text) {
            let i = 0;
            textElement.innerHTML = "";
            cursorElement.style.display = "inline-block";

            if (typingTimeoutId) clearTimeout(typingTimeoutId);
            if (typeWriterTimeoutId) clearTimeout(typeWriterTimeoutId);
            typeWriterTimeoutId = null;

            function typing() {
                if (typingTimeoutId) clearTimeout(typingTimeoutId);
                const isHovering = document.querySelector("#ad-banner:hover");

                if (isHovering) {
                    typingTimeoutId = setTimeout(typing, 200);
                    return;
                }

                if (i < text.length) {
                    textElement.innerHTML += text.charAt(i);
                    i++;
                    typingTimeoutId = setTimeout(typing, TYPEWRITER_SPEED);
                } else {
                    cursorElement.style.display = "none";
                    typeWriterTimeoutId = setTimeout(() => {
                        if (!document.querySelector("#ad-banner:hover")) {
                            typeWriter(textElement, cursorElement, text);
                        } else {
                            typing();
                        }
                    }, RESTART_DELAY);
                }
            }
            typing();
        }

        const textGlowElement = document.querySelector("#ad-banner .text-glow");
        const cursorElement = document.querySelector("#ad-banner .cursor");
        const adBannerElement = document.getElementById("ad-banner");

        if (textGlowElement && cursorElement && adBannerElement) {
            const adMessage = "Adevărat, nu noi folosim alcoolul, ci alcoolul ne folosește pe noi! Nu mai vreau să fiu sclavul unei otrăvi intoxicante! Nu-ți irosi viața, viața este mai scurtă decât crezi!";
            typeWriter(textGlowElement, cursorElement, adMessage);

            adBannerElement.addEventListener("mouseenter", () => {
                if (typeWriterTimeoutId) {
                    clearTimeout(typeWriterTimeoutId);
                    typeWriterTimeoutId = null;
                }
            });

            adBannerElement.addEventListener("mouseleave", () => {
                 const isTypingComplete = textGlowElement.innerHTML === adMessage;
                 if (!typingTimeoutId && !typeWriterTimeoutId && isTypingComplete) {
                     typeWriterTimeoutId = setTimeout(() => {
                         typeWriter(textGlowElement, cursorElement, adMessage);
                     }, 100);
                 } else if (!typingTimeoutId && !isTypingComplete) {
                     // Resume typing if paused mid-text
                     const currentLength = textGlowElement.innerHTML.length;
                     // Need access to 'i' and 'typing' or restart
                     // Simple approach: just restart if paused mid-text
                      if (typeWriterTimeoutId) clearTimeout(typeWriterTimeoutId); // Clear any pending restart just in case
                      typeWriter(textGlowElement, cursorElement, adMessage); // Restart fully
                 }
            });
        } else {
            console.error("Banner elements (.text-glow, .cursor, or #ad-banner) not found!");
        }
        // --- END JavaScript Banner ---

        // --- START JavaScript for Editable Content ---
        document.querySelectorAll('.editable-span').forEach(span => {
            span.addEventListener('blur', (event) => {
                const text = event.target.innerText;
                if (event.target.classList.contains('date-display')) {
                    const dateRegex = /^\d{2}\.\d{2}\.\d{4}$/;
                    if (!dateRegex.test(text)) {
                        console.warn("Format dată invalid:", text, ". Folosiți ZZ.LL.AAAA.");
                    }
                }
                console.log("Edited:", event.target.classList.contains('date-display') ? 'Date' : 'Interval', '=', text);
            });
        });
        // --- END JavaScript for Editable Content ---

        // Initialize Lucide Icons on load
        if (typeof lucide !== 'undefined') {
             lucide.createIcons();
        }

    </script>

    <script type="module">
        import * as THREE from 'three';

        function create3DLogo(canvasId) {
            let logoScene, logoCamera, logoRenderer, ring, vortex, particles = [], clock;

            function init() {
                const canvas = document.getElementById(canvasId);
                if (!canvas) { console.error(`Canvas mit ID "${canvasId}" nicht gefunden.`); return; }
                const container = canvas.parentElement;
                if (!container) { console.error(`Container für Canvas mit ID "${canvasId}" nicht gefunden.`); return; }

                logoScene = new THREE.Scene();
                logoCamera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 1000);
                logoCamera.position.z = 15; // Angepasste Position für kleinere Größe

                logoRenderer = new THREE.WebGLRenderer({ antialias: true, canvas: canvas, alpha: true });
                logoRenderer.setClearColor(0x000000, 0);
                logoRenderer.setPixelRatio(window.devicePixelRatio);
                logoRenderer.setSize(container.clientWidth, container.clientHeight);

                createSceneElements();
                setupInteractions();
                clock = new THREE.Clock();
                animate();
            }

            function createSceneElements() {
                // Kerr-Ring (angepasste Größe)
                const ringGeometry = new THREE.TorusGeometry(3, 0.5, 24, 80); // Kleinerer Radius/Dicke
                const ringMaterial = new THREE.MeshStandardMaterial({ color: 0x00ff99, emissive: 0x00cc77, emissiveIntensity: 0.6, metalness: 0.8, roughness: 0.3 });
                ring = new THREE.Mesh(ringGeometry, ringMaterial);
                logoScene.add(ring);

                // 5D-Gateway-Vortex (angepasste Größe)
                const vortexGeometry = new THREE.SphereGeometry(1.8, 24, 24); // Kleinerer Radius
                const vortexMaterial = new THREE.MeshStandardMaterial({ color: 0x0044ff, emissive: 0x0033cc, emissiveIntensity: 0.5, transparent: true, opacity: 0.4, wireframe: true });
                vortex = new THREE.Mesh(vortexGeometry, vortexMaterial);
                logoScene.add(vortex);

                // Teilchenstrom (weniger Partikel, angepasst)
                const particleGeometry = new THREE.SphereGeometry(0.06, 6, 6); // Noch kleinere Partikel
                const particleMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
                for (let i = 0; i < 80; i++) { // Weniger Partikel
                    const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                    particle.userData = {
                        angle: Math.random() * Math.PI * 2,
                        radius: 1.5 + Math.random() * 0.8, // Angepasster Radius
                        height: -1.5 + Math.random() * 3, // Angepasste Höhe
                        speed: 0.01 + Math.random() * 0.015 // Leicht höhere max. Geschwindigkeit
                    };
                    logoScene.add(particle);
                    particles.push(particle);
                }

                const ambientLight = new THREE.AmbientLight(0x555555);
                const pointLight = new THREE.PointLight(0x00ffaa, 1.5, 30);
                pointLight.position.set(7, 7, 7);
                logoScene.add(ambientLight);
                logoScene.add(pointLight);
            }

            function setupInteractions() {
                const raycaster = new THREE.Raycaster();
                const mouse = new THREE.Vector2();
                const canvas = logoRenderer.domElement;

                canvas.addEventListener('click', (event) => {
                    const rect = canvas.getBoundingClientRect();
                    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                    raycaster.setFromCamera(mouse, logoCamera);
                    const intersects = raycaster.intersectObject(vortex);
                    if (intersects.length > 0) {
                        vortex.material.color.set(Math.random() * 0xffffff);
                        vortex.material.emissive.set(vortex.material.color);
                        console.log("Vortex geklickt!");
                    }
                });
            }

            function animate() {
                requestAnimationFrame(animate);
                const t = clock.getElapsedTime();
                const scale = 1 + Math.sin(t * 1.5) * 0.1;
                vortex.scale.set(scale, scale, scale);

                const intensity = 0.5 + Math.abs(Math.sin(t * 1.5)) * 0.5;
                 if (vortex.material.emissiveIntensity !== undefined) { vortex.material.emissiveIntensity = intensity; }
                 if (ring.material.emissiveIntensity !== undefined) { ring.material.emissiveIntensity = 0.6 + Math.abs(Math.sin(t * 0.8)) * 0.4; }

                ring.rotation.x += 0.005;
                ring.rotation.y += 0.01;
                vortex.rotation.y -= 0.002;

                particles.forEach(p => {
                    const userData = p.userData;
                    userData.angle += userData.speed;
                    p.position.x = Math.cos(userData.angle) * userData.radius;
                    p.position.z = Math.sin(userData.angle) * userData.radius;
                    p.position.y = userData.height + Math.sin(userData.angle * 1.5) * 0.5;
                });

                logoRenderer.render(logoScene, logoCamera);
            }

            function resize(width, height) {
                 if (!logoRenderer || !logoCamera) return;
                 // Verhindere Division durch Null oder ungültige Größe
                 if (width <= 0 || height <= 0) return;
                 logoCamera.aspect = width / height;
                 logoCamera.updateProjectionMatrix();
                 logoRenderer.setSize(width, height);
            }

            init();
            return { resize };
        }

        // ----- Logo Initialisierung und Resize Handling -----
        try {
            const logoInstance = create3DLogo('logo-canvas');
            const handleResize = () => {
                const container = document.getElementById('logo-container');
                if (container && logoInstance && typeof logoInstance.resize === 'function') {
                    // Sicherstellen, dass die Größe positiv ist
                    const width = Math.max(1, container.clientWidth);
                    const height = Math.max(1, container.clientHeight);
                    logoInstance.resize(width, height);
                } else if (!container) {
                    console.warn("Logo-Container nicht gefunden für Resize.");
                } else if (!logoInstance || typeof logoInstance.resize !== 'function') {
                     console.warn("Logo-Instanz oder resize-Funktion nicht verfügbar.");
                }
            };
            window.addEventListener('resize', handleResize);
            setTimeout(handleResize, 150); // Etwas längeres Timeout

        } catch (error) {
             console.error("Fehler bei der Initialisierung des 3D-Logos:", error);
             const logoContainer = document.getElementById('logo-container');
             if(logoContainer) {
                 const errorMsg = document.createElement('p');
                 errorMsg.textContent = 'Logo Fehler'; // Kürzer
                 errorMsg.style.color = 'red'; errorMsg.style.fontSize = '9px';
                 errorMsg.style.textAlign = 'center'; errorMsg.style.padding = '2px';
                 logoContainer.appendChild(errorMsg);
                 const canvas = document.getElementById('logo-canvas');
                 if (canvas) canvas.style.display = 'none';
             }
        }
    </script>

</body>
</html>
